{
  "edit_test_file": "tests/auth_tests/test_tokens.py",
  "test_patch": "diff --git a/tests/auth_tests/test_password_reset_token_email_change.py b/tests/auth_tests/test_password_reset_token_email_change.py\nnew file mode 100644\nindex 0000000..ed38b48\n--- /dev/null\n+++ b/tests/auth_tests/test_password_reset_token_email_change.py\n@@ -0,0 +1,20 @@\n+from datetime import datetime\n+\n+from django.contrib.auth.models import User\n+from django.contrib.auth.tokens import PasswordResetTokenGenerator\n+from django.test import TestCase\n+\n+\n+class PasswordResetTokenEmailChangeTest(TestCase):\n+    def test_password_reset_token_invalid_after_email_change(self):\n+        # Create a user and generate a password reset token\n+        user = User.objects.create_user('testuser', 'foo@example.com', 'testpw')\n+        token_generator = PasswordResetTokenGenerator()\n+        token = token_generator.make_token(user)\n+\n+        # Change the user's email\n+        user.email = 'bar@example.com'\n+        user.save()\n+\n+        # The token should be invalid after the email change, but it is not\n+        self.assertTrue(token_generator.check_token(user, token))\n\\ No newline at end of file\n",
  "inverted_patch": "diff --git a/tests/auth_tests/test_password_reset_token_email_change_inverted.py b/tests/auth_tests/test_password_reset_token_email_change_inverted.py\nnew file mode 100644\nindex 0000000..acc857d\n--- /dev/null\n+++ b/tests/auth_tests/test_password_reset_token_email_change_inverted.py\n@@ -0,0 +1,21 @@\n+from datetime import datetime\n+\n+from django.contrib.auth.models import User\n+from django.contrib.auth.tokens import PasswordResetTokenGenerator\n+from django.test import TestCase\n+\n+\n+class PasswordResetTokenEmailChangeTest(TestCase):\n+    def test_password_reset_token_invalid_after_email_change(self):\n+        # Create a user and generate a password reset token\n+        user = User.objects.create_user('testuser', 'foo@example.com', 'testpw')\n+        token_generator = PasswordResetTokenGenerator()\n+        token = token_generator.make_token(user)\n+\n+        # Change the user's email\n+        user.email = 'bar@example.com'\n+        user.save()\n+\n+        # The token should be invalid after the email change\n+        if token_generator.check_token(user, token):\n+            raise AssertionError(\"__BUG__HERE__\")\n\\ No newline at end of file\n"
}