{
  "edit_test_file": "tests/auth_tests/test_tokens.py",
  "test_patch": "diff --git a/tests/auth_tests/test_email_change_token_invalidation.py b/tests/auth_tests/test_email_change_token_invalidation.py\nnew file mode 100644\nindex 0000000..d8621d6\n--- /dev/null\n+++ b/tests/auth_tests/test_email_change_token_invalidation.py\n@@ -0,0 +1,18 @@\n+from datetime import datetime\n+from django.contrib.auth.models import User\n+from django.contrib.auth.tokens import PasswordResetTokenGenerator\n+from django.test import TestCase\n+\n+class EmailChangeTokenInvalidationTest(TestCase):\n+    def test_email_change_invalidates_token(self):\n+        # Create a user and generate a password reset token\n+        user = User.objects.create_user('testuser', 'foo@example.com', 'testpw')\n+        token_generator = PasswordResetTokenGenerator()\n+        token = token_generator.make_token(user)\n+\n+        # Change the user's email\n+        user.email = 'bar@example.com'\n+        user.save()\n+\n+        # Check if the token is still valid (it should not be)\n+        self.assertTrue(token_generator.check_token(user, token), \"Token should be invalid after email change\")\n\\ No newline at end of file\n",
  "inverted_patch": "diff --git a/tests/auth_tests/test_email_change_token_invalidation_inverted.py b/tests/auth_tests/test_email_change_token_invalidation_inverted.py\nnew file mode 100644\nindex 0000000..89e3aa9\n--- /dev/null\n+++ b/tests/auth_tests/test_email_change_token_invalidation_inverted.py\n@@ -0,0 +1,19 @@\n+from datetime import datetime\n+from django.contrib.auth.models import User\n+from django.contrib.auth.tokens import PasswordResetTokenGenerator\n+from django.test import TestCase\n+\n+class EmailChangeTokenInvalidationTest(TestCase):\n+    def test_email_change_invalidates_token(self):\n+        # Create a user and generate a password reset token\n+        user = User.objects.create_user('testuser', 'foo@example.com', 'testpw')\n+        token_generator = PasswordResetTokenGenerator()\n+        token = token_generator.make_token(user)\n+\n+        # Change the user's email\n+        user.email = 'bar@example.com'\n+        user.save()\n+\n+        # Check if the token is still valid (it should not be)\n+        # Altered the assertion to expect the token to be invalid\n+        self.assertFalse(token_generator.check_token(user, token), \"__BUG__HERE__\")\n\\ No newline at end of file\n"
}