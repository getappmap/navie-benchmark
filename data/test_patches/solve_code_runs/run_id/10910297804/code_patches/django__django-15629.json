{
  "instance_id": "django__django-15629",
  "edit_test_file": null,
  "code_patch": "diff --git a/django/db/backends/base/schema.py b/django/db/backends/base/schema.py\nindex 696bfd7..e33bbcd 100644\n--- a/django/db/backends/base/schema.py\n+++ b/django/db/backends/base/schema.py\n@@ -922,6 +922,12 @@ class BaseDatabaseSchemaEditor:\n                 model, new_field, new_type, new_collation\n             )\n             actions.append(fragment)\n+            # Propagate collation change to related foreign keys\n+            for _old_rel, new_rel in _related_non_m2m_objects(old_field, new_field):\n+                rel_fragment = self._alter_column_collation_sql(\n+                    new_rel.related_model, new_rel.field, new_type, new_collation\n+                )\n+                actions.append(rel_fragment)\n         # Type change?\n         elif (old_type, old_type_suffix) != (new_type, new_type_suffix):\n             fragment, other_actions = self._alter_column_type_sql(\n\ndiff --git a/django/db/backends/mysql/schema.py b/django/db/backends/mysql/schema.py\nindex 562b209..47ae227 100644\n--- a/django/db/backends/mysql/schema.py\n+++ b/django/db/backends/mysql/schema.py\n@@ -18,7 +18,7 @@ class DatabaseSchemaEditor(BaseDatabaseSchemaEditor):\n     sql_delete_unique = \"ALTER TABLE %(table)s DROP INDEX %(name)s\"\n     sql_create_column_inline_fk = (\n         \", ADD CONSTRAINT %(name)s FOREIGN KEY (%(column)s) \"\n-        \"REFERENCES %(to_table)s(%(to_column)s)\"\n+        \"REFERENCES %(to_table)s(%(to_column)s)%(collation)s\"\n     )\n     sql_delete_fk = \"ALTER TABLE %(table)s DROP FOREIGN KEY %(name)s\"\n \n",
  "test_patch": null,
  "test_inverted_patch": null,
  "num_sent_chars": 1967995,
  "num_received_chars": 26401,
  "elapsed_time": 208.95201635360718,
  "lint_repair_count": 0,
  "test_generation_attempts": 9,
  "code_generation_attempts": 1,
  "pass_to_pass": true,
  "pass_to_fail": false,
  "fail_to_pass": false,
  "code_patch_score": 1,
  "appmap_data_test_status": null,
  "appmap_data_file_count": null,
  "appmap_data_context_size": null
}