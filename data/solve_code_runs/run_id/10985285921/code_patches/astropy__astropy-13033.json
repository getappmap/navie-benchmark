{
  "instance_id": "astropy__astropy-13033",
  "edit_test_file": "astropy/io/votable/tests/tree_test.py",
  "code_patch": "diff --git a/astropy/timeseries/core.py b/astropy/timeseries/core.py\nindex c279f35..c551bab 100644\n--- a/astropy/timeseries/core.py\n+++ b/astropy/timeseries/core.py\n@@ -69,16 +69,15 @@ class BaseTimeSeries(QTable):\n             plural = 's' if len(required_columns) > 1 else ''\n \n             if not self._required_columns_relax and len(self.colnames) == 0:\n-\n-                raise ValueError(\"{} object is invalid - expected '{}' \"\n-                                 \"as the first column{} but time series has no columns\"\n-                                 .format(self.__class__.__name__, required_columns[0], plural))\n+                missing_columns = \"', '\".join(required_columns)\n+                raise ValueError(\"{} object is invalid - missing required column{} '{}'\"\n+                                 .format(self.__class__.__name__, plural, missing_columns))\n \n             elif self.colnames[:len(required_columns)] != required_columns:\n-\n-                raise ValueError(\"{} object is invalid - expected '{}' \"\n-                                 \"as the first column{} but found '{}'\"\n-                                 .format(self.__class__.__name__, required_columns[0], plural, self.colnames[0]))\n+                for i, col in enumerate(required_columns):\n+                    if i >= len(self.colnames) or self.colnames[i] != col:\n+                        raise ValueError(\"{} object is invalid - missing required column '{}'\"\n+                                         .format(self.__class__.__name__, col))\n \n             if (self._required_columns_relax\n                     and self._required_columns == self.colnames[:len(self._required_columns)]):\n",
  "test_patch": "diff --git a/astropy/io/votable/tests/timeseries_exception_test.py b/astropy/io/votable/tests/timeseries_exception_test.py\nnew file mode 100644\nindex 0000000..e4c4c26\n--- /dev/null\n+++ b/astropy/io/votable/tests/timeseries_exception_test.py\n@@ -0,0 +1,12 @@\n+import pytest\n+import numpy as np\n+from astropy.time import Time\n+from astropy.timeseries import TimeSeries\n+\n+def test_timeseries_required_column_exception():\n+    time = Time(np.arange(100000, 100003), format='jd')\n+    ts = TimeSeries(time=time, data={\"flux\": [99.9, 99.8, 99.7]})\n+    ts._required_columns = [\"time\", \"flux\"]\n+    \n+    with pytest.raises(ValueError, match=r\"TimeSeries object is invalid - expected 'time' as the first columns but found 'time'\"):\n+        ts.remove_column(\"flux\")\n",
  "test_inverted_patch": "diff --git a/astropy/io/votable/tests/timeseries_exception_test_inverted.py b/astropy/io/votable/tests/timeseries_exception_test_inverted.py\nnew file mode 100644\nindex 0000000..0514dd9\n--- /dev/null\n+++ b/astropy/io/votable/tests/timeseries_exception_test_inverted.py\n@@ -0,0 +1,13 @@\n+import pytest\n+import numpy as np\n+from astropy.time import Time\n+from astropy.timeseries import TimeSeries\n+\n+def test_timeseries_required_column_exception():\n+    time = Time(np.arange(100000, 100003), format='jd')\n+    ts = TimeSeries(time=time, data={\"flux\": [99.9, 99.8, 99.7]})\n+    ts._required_columns = [\"time\", \"flux\"]\n+    \n+    # Alter the test to fail when the issue is observed\n+    with pytest.raises(ValueError, match=r\"__BUG__HERE__\"):\n+        ts.remove_column(\"flux\")\n",
  "num_sent_chars": 3261402,
  "num_received_chars": 36311,
  "elapsed_time": 310.17325830459595,
  "lint_repair_count": 1,
  "test_generation_attempts": 0,
  "code_generation_attempts": 9,
  "pass_to_pass": true,
  "pass_to_fail": true,
  "fail_to_pass": false,
  "code_patch_score": 2,
  "appmap_data_test_status": null,
  "appmap_data_file_count": null,
  "appmap_data_context_size": null
}