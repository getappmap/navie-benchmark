{
  "edit_test_file": "lib/matplotlib/tests/test_widgets.py",
  "test_patch": "diff --git a/lib/matplotlib/tests/test_mplcursor_compatibility.py b/lib/matplotlib/tests/test_mplcursor_compatibility.py\nnew file mode 100644\nindex 0000000..0f84f3d\n--- /dev/null\n+++ b/lib/matplotlib/tests/test_mplcursor_compatibility.py\n@@ -0,0 +1,41 @@\n+import numpy as np\n+import matplotlib.pyplot as plt\n+import pytest\n+from matplotlib.testing.decorators import check_figures_equal\n+from matplotlib.backend_bases import MouseEvent\n+\n+try:\n+    import mplcursors\n+except ImportError:\n+    pytestmark = pytest.mark.skip('mplcursors not installed')\n+\n+def test_mplcursor_attribute_error():\n+    \"\"\"Test that mplcursor raises AttributeError after multiple clicks.\"\"\"\n+    # Create test data\n+    x = np.arange(1, 11)\n+    y = x\n+    \n+    # Create figure and plot\n+    fig, ax = plt.subplots()\n+    scatter = ax.scatter(x, y)\n+    \n+    # Add cursor\n+    cursor = mplcursors.cursor()\n+    \n+    # Simulate multiple clicks on data points\n+    canvas = fig.canvas\n+    \n+    # First click should work\n+    event = MouseEvent('button_press_event', canvas, 1, 1)  # Click near point (1,1)\n+    canvas.callbacks.process('button_press_event', event)\n+    \n+    # Second click should work\n+    event = MouseEvent('button_press_event', canvas, 2, 2)  # Click near point (2,2) \n+    canvas.callbacks.process('button_press_event', event)\n+    \n+    # Third click should raise AttributeError\n+    with pytest.raises(AttributeError, match=\"'NoneType' object has no attribute 'canvas'\"):\n+        event = MouseEvent('button_press_event', canvas, 3, 3)  # Click near point (3,3)\n+        canvas.callbacks.process('button_press_event', event)\n+\n+    plt.close()\n\\ No newline at end of file\n",
  "inverted_patch": null
}