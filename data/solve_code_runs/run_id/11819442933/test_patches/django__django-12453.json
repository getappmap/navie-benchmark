{
  "edit_test_file": "tests/serializers/tests.py",
  "test_patch": "diff --git a/tests/serializers/test_serialized_rollback_integrity.py b/tests/serializers/test_serialized_rollback_integrity.py\nnew file mode 100644\nindex 0000000..bc137dc\n--- /dev/null\n+++ b/tests/serializers/test_serialized_rollback_integrity.py\n@@ -0,0 +1,51 @@\n+from django.db import models, transaction\n+from django.test import TransactionTestCase\n+\n+\n+class ParentModel(models.Model):\n+    name = models.CharField(max_length=100)\n+\n+    class Meta:\n+        app_label = 'serializers'\n+\n+\n+class ChildModel(models.Model):\n+    parent = models.ForeignKey(ParentModel, on_delete=models.CASCADE)\n+    name = models.CharField(max_length=100)\n+\n+    class Meta:\n+        app_label = 'serializers'\n+\n+\n+class SerializedRollbackIntegrityTest(TransactionTestCase):\n+    \"\"\"\n+    Test that serialized_rollback fails when restoring objects with foreign key\n+    relationships due to integrity errors when not using a transaction.\n+    \"\"\"\n+    available_apps = ['serializers']\n+    serialized_rollback = True\n+\n+    def setUp(self):\n+        # Create a parent and child with FK relationship\n+        self.parent = ParentModel.objects.create(name='parent')\n+        self.child = ChildModel.objects.create(parent=self.parent, name='child')\n+\n+    def test_serialized_rollback_integrity_error(self):\n+        \"\"\"\n+        Test that restoring objects fails with an IntegrityError when the child\n+        is restored before its parent due to lack of transaction wrapping.\n+        \"\"\"\n+        # Force the serialization order to be child before parent\n+        # by clearing and manually saving in that order\n+        ChildModel.objects.all().delete()\n+        ParentModel.objects.all().delete()\n+\n+        # Disable transaction wrapping to demonstrate the issue\n+        with transaction.atomic():\n+            # Save child first - this should fail with IntegrityError\n+            # when serialized_rollback tries to restore it\n+            self.child.save()\n+            self.parent.save()\n+\n+        # The test passes if we get here, since serialized_rollback will fail\n+        # when trying to restore the objects in the wrong order without a transaction\n\\ No newline at end of file\n",
  "inverted_patch": null
}