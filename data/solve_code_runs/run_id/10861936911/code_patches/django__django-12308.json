{
  "instance_id": "django__django-12308",
  "edit_test_file": "tests/admin_utils/tests.py",
  "code_patch": "diff --git a/django/contrib/admin/utils.py b/django/contrib/admin/utils.py\nindex e4ddc8f..a8c991a 100644\n--- a/django/contrib/admin/utils.py\n+++ b/django/contrib/admin/utils.py\n@@ -379,6 +379,7 @@ def help_text_for_field(name, model):\n \n def display_for_field(value, field, empty_value_display):\n     from django.contrib.admin.templatetags.admin_list import _boolean_icon\n+    from django.forms.fields import JSONField, InvalidJSONInput\n \n     if getattr(field, 'flatchoices', None):\n         return dict(field.flatchoices).get(value, empty_value_display)\n@@ -398,6 +399,8 @@ def display_for_field(value, field, empty_value_display):\n         return formats.number_format(value)\n     elif isinstance(field, models.FileField) and value:\n         return format_html('<a href=\"{}\">{}</a>', value.url, value)\n+    elif isinstance(field, JSONField):\n+        return field.prepare_value(value) if not isinstance(value, InvalidJSONInput) else str(value)\n     else:\n         return display_for_value(value, empty_value_display)\n \n",
  "test_patch": "diff --git a/tests/admin_utils/test_jsonfield_display.py b/tests/admin_utils/test_jsonfield_display.py\nnew file mode 100644\nindex 0000000..ef43a14\n--- /dev/null\n+++ b/tests/admin_utils/test_jsonfield_display.py\n@@ -0,0 +1,20 @@\n+import json\n+from django.test import TestCase\n+from django.contrib.admin.utils import display_for_field\n+from django.forms import JSONField\n+from django.db import models\n+\n+class ReadOnlyJSONFieldModel(models.Model):\n+    json_data = models.JSONField()\n+\n+class JSONFieldDisplayTest(TestCase):\n+    def test_jsonfield_display_as_dict_when_readonly(self):\n+        # Create a model instance with JSON data\n+        instance = ReadOnlyJSONFieldModel(json_data={\"foo\": \"bar\"})\n+        \n+        # Simulate the display of the JSONField in the admin when it's readonly\n+        field = instance._meta.get_field('json_data')\n+        output = display_for_field(instance.json_data, field, 'readonly')\n+        \n+        # Assert that the output is incorrectly displayed as a dict\n+        self.assertEqual(output, \"{'foo': 'bar'}\")\n\\ No newline at end of file\n",
  "test_inverted_patch": "diff --git a/tests/admin_utils/test_jsonfield_display_inverted.py b/tests/admin_utils/test_jsonfield_display_inverted.py\nnew file mode 100644\nindex 0000000..defe3aa\n--- /dev/null\n+++ b/tests/admin_utils/test_jsonfield_display_inverted.py\n@@ -0,0 +1,22 @@\n+import json\n+from django.test import TestCase\n+from django.contrib.admin.utils import display_for_field\n+from django.forms import JSONField\n+from django.db import models\n+\n+class ReadOnlyJSONFieldModel(models.Model):\n+    json_data = models.JSONField()\n+\n+class JSONFieldDisplayTest(TestCase):\n+    def test_jsonfield_display_as_dict_when_readonly(self):\n+        # Create a model instance with JSON data\n+        instance = ReadOnlyJSONFieldModel(json_data={\"foo\": \"bar\"})\n+        \n+        # Simulate the display of the JSONField in the admin when it's readonly\n+        field = instance._meta.get_field('json_data')\n+        output = display_for_field(instance.json_data, field, 'readonly')\n+        \n+        # Assert that the output is incorrectly displayed as a dict\n+        # This should now fail if the bug is present\n+        if output == \"{'foo': 'bar'}\":\n+            raise AssertionError(\"__BUG__HERE__\")\n\\ No newline at end of file\n",
  "num_sent_chars": 1717614,
  "num_received_chars": 84572,
  "elapsed_time": 691.4479253292084,
  "lint_repair_count": 5,
  "test_generation_attempts": 0,
  "code_generation_attempts": 18,
  "pass_to_pass": true,
  "pass_to_fail": false,
  "fail_to_pass": false,
  "code_patch_score": 1,
  "appmap_data_test_status": null,
  "appmap_data_file_count": null,
  "appmap_data_context_size": null
}