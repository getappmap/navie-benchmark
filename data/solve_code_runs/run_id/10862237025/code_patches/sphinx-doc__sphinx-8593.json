{
  "instance_id": "sphinx-doc__sphinx-8593",
  "edit_test_file": "tests/test_ext_autodoc_autoattribute.py",
  "code_patch": "diff --git a/sphinx/ext/autodoc/__init__.py b/sphinx/ext/autodoc/__init__.py\nindex 76265f5..8db2744 100644\n--- a/sphinx/ext/autodoc/__init__.py\n+++ b/sphinx/ext/autodoc/__init__.py\n@@ -662,21 +662,24 @@ class Documenter:\n     def filter_members(self, members: ObjectMembers, want_all: bool\n                        ) -> List[Tuple[str, Any, bool]]:\n         \"\"\"Filter the given member list.\n-\n+    \n         Members are skipped if\n-\n+    \n         - they are private (except if given explicitly or the private-members\n           option is set)\n         - they are special methods (except if given explicitly or the\n           special-members option is set)\n         - they are undocumented (except if the undoc-members option is set)\n-\n+    \n         The user can override the skipping decision by connecting to the\n         ``autodoc-skip-member`` event.\n         \"\"\"\n         def is_filtered_inherited_member(name: str, obj: Any) -> bool:\n             if inspect.isclass(self.object):\n                 for cls in self.object.__mro__:\n+                    # Check for :meta public: directive\n+                    if hasattr(obj, '__doc__') and ':meta public:' in (obj.__doc__ or ''):\n+                        return False\n                     if cls.__name__ == self.options.inherited_members and cls != self.object:\n                         # given member is a member of specified *super class*\n                         return True\n\ndiff --git a/sphinx/ext/autodoc/importer.py b/sphinx/ext/autodoc/importer.py\nindex 1c5ea97..6c140ab 100644\n--- a/sphinx/ext/autodoc/importer.py\n+++ b/sphinx/ext/autodoc/importer.py\n@@ -193,6 +193,11 @@ def get_object_members(subject: Any, objpath: List[str], attrgetter: Callable,\n             if name not in members:\n                 members[name] = Attribute(name, True, value)\n \n+    # Check for :meta public: directive\n+    for name, value in obj_dict.items():\n+        if hasattr(value, '__doc__') and ':meta public:' in (value.__doc__ or ''):\n+            members[name] = Attribute(name, True, value)\n+\n         superclass = subject.__mro__[1]\n         for name in obj_dict:\n             if name not in superclass.__dict__:\n",
  "test_patch": "diff --git a/tests/test_ext_autodoc_meta_public.py b/tests/test_ext_autodoc_meta_public.py\nnew file mode 100644\nindex 0000000..43f09a4\n--- /dev/null\n+++ b/tests/test_ext_autodoc_meta_public.py\n@@ -0,0 +1,19 @@\n+\"\"\"\n+    test_ext_autodoc_meta_public\n+    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+    Test the autodoc extension for `:meta public:` effect on variables.\n+\n+    :copyright: Copyright 2007-2020 by the Sphinx team, see AUTHORS.\n+    :license: BSD, see LICENSE for details.\n+\"\"\"\n+\n+import pytest\n+from .test_ext_autodoc import do_autodoc\n+\n+\n+@pytest.mark.sphinx('html', testroot='ext-autodoc')\n+def test_meta_public_variable(app):\n+    # This test checks if the `:meta public:` directive affects variables as expected.\n+    actual = do_autodoc(app, 'module', 'example', {'members': True})\n+    assert '_foo' not in list(actual), \"Expected '_foo' to be shown, but it is not.\"\n\\ No newline at end of file\n",
  "test_inverted_patch": "diff --git a/tests/test_ext_autodoc_meta_public_inverted.py b/tests/test_ext_autodoc_meta_public_inverted.py\nnew file mode 100644\nindex 0000000..e9e6a12\n--- /dev/null\n+++ b/tests/test_ext_autodoc_meta_public_inverted.py\n@@ -0,0 +1,19 @@\n+\"\"\"\n+    test_ext_autodoc_meta_public\n+    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+    Test the autodoc extension for `:meta public:` effect on variables.\n+\n+    :copyright: Copyright 2007-2020 by the Sphinx team, see AUTHORS.\n+    :license: BSD, see LICENSE for details.\n+\"\"\"\n+\n+import pytest\n+from .test_ext_autodoc import do_autodoc\n+\n+\n+@pytest.mark.sphinx('html', testroot='ext-autodoc')\n+def test_meta_public_variable(app):\n+    # This test checks if the `:meta public:` directive affects variables as expected.\n+    actual = do_autodoc(app, 'module', 'example', {'members': True})\n+    assert '_foo' in list(actual), \"__BUG__HERE__\"\n\\ No newline at end of file\n",
  "num_sent_chars": 4010295,
  "num_received_chars": 125935,
  "elapsed_time": 1064.082465171814,
  "lint_repair_count": 12,
  "test_generation_attempts": 0,
  "code_generation_attempts": 18,
  "pass_to_pass": true,
  "pass_to_fail": false,
  "fail_to_pass": false,
  "code_patch_score": 1,
  "appmap_data_test_status": "PASSED",
  "appmap_data_file_count": 1,
  "appmap_data_context_size": 19751
}