{
  "instance_id": "sympy__sympy-18763",
  "edit_test_file": "sympy/printing/tests/test_pycode.py",
  "code_patch": "diff --git a/sympy/printing/latex.py b/sympy/printing/latex.py\nindex 8743723..f23bb64 100644\n--- a/sympy/printing/latex.py\n+++ b/sympy/printing/latex.py\n@@ -699,6 +699,8 @@ def _print_Derivative(self, expr):\n     def _print_Subs(self, subs):\n         expr, old, new = subs.args\n         latex_expr = self._print(expr)\n+        if expr.is_Add or expr.is_Mul:\n+            latex_expr = r'\\left(%s\\right)' % latex_expr\n         latex_old = (self._print(e) for e in old)\n         latex_new = (self._print(e) for e in new)\n         latex_subs = r'\\\\ '.join(\n\ndiff --git a/sympy/printing/pretty/stringpict.py b/sympy/printing/pretty/stringpict.py\nindex 9971b20..0eb2fd6 100644\n--- a/sympy/printing/pretty/stringpict.py\n+++ b/sympy/printing/pretty/stringpict.py\n@@ -450,7 +450,7 @@ def __mul__(self, *others):\n             if arg.picture[0] not in quantity.values():\n                 result.append(xsym('*'))\n             #add parentheses for weak binders\n-            if arg.binding > prettyForm.MUL:\n+            if arg.binding > prettyForm.MUL or isinstance(arg, prettyForm) and arg.binding == prettyForm.ADD:\n                 arg = stringPict(*arg.parens())\n             result.append(arg)\n         len_res = len(result)\n",
  "test_patch": "diff --git a/sympy/printing/tests/test_subs_parenthesizing.py b/sympy/printing/tests/test_subs_parenthesizing.py\nnew file mode 100644\nindex 0000000..66bacc2\n--- /dev/null\n+++ b/sympy/printing/tests/test_subs_parenthesizing.py\n@@ -0,0 +1,8 @@\n+from sympy import Subs, latex\n+from sympy.abc import x, y\n+\n+def test_subs_parenthesizing():\n+    expr = 3 * Subs(-x + y, (x,), (1,))\n+    latex_output = latex(expr)\n+    expected_output = r\"3 \\left. \\left(- x + y\\right) \\right|_{\\substack{ x=1 }}\"\n+    assert latex_output != expected_output, f\"Expected incorrect output, got: {latex_output}\"\n\\ No newline at end of file\n",
  "test_inverted_patch": null,
  "num_sent_chars": 1207907,
  "num_received_chars": 28628,
  "elapsed_time": 329.6243598461151,
  "lint_repair_count": 2,
  "test_generation_attempts": 9,
  "code_generation_attempts": 2,
  "pass_to_pass": true,
  "pass_to_fail": true,
  "fail_to_pass": false,
  "code_patch_score": 2,
  "appmap_data_test_status": null,
  "appmap_data_file_count": null,
  "appmap_data_context_size": null
}