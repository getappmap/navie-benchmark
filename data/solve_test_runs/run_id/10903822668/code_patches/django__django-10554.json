{
  "instance_id": "django__django-10554",
  "edit_test_file": null,
  "code_patch": "diff --git a/django/db/models/query.py b/django/db/models/query.py\nindex 1544beb..0918c07 100644\n--- a/django/db/models/query.py\n+++ b/django/db/models/query.py\n@@ -934,6 +934,14 @@ class QuerySet:\n         clone.query.combined_queries = (self.query,) + tuple(qs.query for qs in other_qs)\n         clone.query.combinator = combinator\n         clone.query.combinator_all = all\n+\n+        # Ensure that order_by fields are present in the select list\n+        if clone.query.order_by:\n+            select_fields = set(clone.query.values_select)\n+            for order_by_expr in clone.query.order_by:\n+                if isinstance(order_by_expr, str) and order_by_expr not in select_fields:\n+                    raise ValueError(f\"ORDER BY field '{order_by_expr}' must be present in the select list for UNION.\")\n+\n         return clone\n \n     def union(self, *other_qs, all=False):\n",
  "test_patch": null,
  "test_inverted_patch": null,
  "num_sent_chars": 1086177,
  "num_received_chars": 24555,
  "elapsed_time": 203.47730779647827,
  "lint_repair_count": 0,
  "test_generation_attempts": 9,
  "code_generation_attempts": 1,
  "pass_to_pass": true,
  "pass_to_fail": false,
  "fail_to_pass": false,
  "code_patch_score": 1,
  "appmap_data_test_status": null,
  "appmap_data_file_count": null,
  "appmap_data_context_size": null
}