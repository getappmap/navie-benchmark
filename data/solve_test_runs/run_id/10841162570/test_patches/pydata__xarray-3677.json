{
  "edit_test_file": "xarray/tests/test_merge.py",
  "test_patch": "diff --git a/xarray/tests/test_integration.py b/xarray/tests/test_integration.py\nnew file mode 100644\nindex 0000000..028724d\n--- /dev/null\n+++ b/xarray/tests/test_integration.py\n@@ -0,0 +1,14 @@\n+import pytest\n+import xarray as xr\n+\n+def test_merge_dataset_with_dataarray():\n+    ds = xr.Dataset({'a': 0})\n+    da = xr.DataArray(1, name='b')\n+\n+    # This should work fine\n+    expected = xr.merge([ds, da])\n+    assert expected.identical(xr.Dataset({'a': 0, 'b': 1}))\n+\n+    # This should raise an AttributeError\n+    with pytest.raises(AttributeError, match=\"'DataArray' object has no attribute 'items'\"):\n+        ds.merge(da)\n\\ No newline at end of file\n",
  "inverted_patch": "diff --git a/xarray/tests/test_integration_inverted.py b/xarray/tests/test_integration_inverted.py\nnew file mode 100644\nindex 0000000..f1fec2e\n--- /dev/null\n+++ b/xarray/tests/test_integration_inverted.py\n@@ -0,0 +1,17 @@\n+import pytest\n+import xarray as xr\n+\n+def test_merge_dataset_with_dataarray():\n+    ds = xr.Dataset({'a': 0})\n+    da = xr.DataArray(1, name='b')\n+\n+    # This should work fine\n+    expected = xr.merge([ds, da])\n+    assert expected.identical(xr.Dataset({'a': 0, 'b': 1}))\n+\n+    # This should now fail with a custom error message\n+    try:\n+        ds.merge(da)\n+    except AttributeError as e:\n+        assert str(e) == \"'DataArray' object has no attribute 'items'\"\n+        raise AssertionError(\"__BUG__HERE__\")\n\\ No newline at end of file\n"
}