{
  "edit_test_file": "astropy/nddata/tests/test_nddata.py",
  "test_patch": "diff --git a/astropy/nddata/tests/test_nddataref_mask_propagation.py b/astropy/nddata/tests/test_nddataref_mask_propagation.py\nnew file mode 100644\nindex 0000000..abf1a43\n--- /dev/null\n+++ b/astropy/nddata/tests/test_nddataref_mask_propagation.py\n@@ -0,0 +1,20 @@\n+# Licensed under a 3-clause BSD style license - see LICENSE.rst\n+\n+import numpy as np\n+from astropy.nddata import NDDataRef\n+import pytest\n+\n+def test_nddataref_mask_propagation_issue():\n+    array = np.array([[0, 1, 0], [1, 0, 1], [0, 1, 0]])\n+    mask = np.array([[0, 1, 64], [8, 0, 1], [2, 1, 0]])\n+\n+    nref_nomask = NDDataRef(array)\n+    nref_mask = NDDataRef(array, mask=mask)\n+\n+    # Test multiplication of mask by constant (mask * no mask)\n+    with pytest.raises(TypeError, match=\"unsupported operand type(s) for |: 'int' and 'NoneType'\"):\n+        nref_mask.multiply(1., handle_mask=np.bitwise_or).mask\n+\n+    # Test multiplication of mask by no mask (mask * no mask)\n+    with pytest.raises(TypeError, match=\"unsupported operand type(s) for |: 'int' and 'NoneType'\"):\n+        nref_mask.multiply(nref_nomask, handle_mask=np.bitwise_or).mask\n",
  "inverted_patch": "diff --git a/astropy/nddata/tests/test_nddataref_mask_propagation_inverted.py b/astropy/nddata/tests/test_nddataref_mask_propagation_inverted.py\nnew file mode 100644\nindex 0000000..f826be0\n--- /dev/null\n+++ b/astropy/nddata/tests/test_nddataref_mask_propagation_inverted.py\n@@ -0,0 +1,24 @@\n+# Licensed under a 3-clause BSD style license - see LICENSE.rst\n+\n+import numpy as np\n+from astropy.nddata import NDDataRef\n+import pytest\n+\n+def test_nddataref_mask_propagation_issue():\n+    array = np.array([[0, 1, 0], [1, 0, 1], [0, 1, 0]])\n+    mask = np.array([[0, 1, 64], [8, 0, 1], [2, 1, 0]])\n+\n+    nref_nomask = NDDataRef(array)\n+    nref_mask = NDDataRef(array, mask=mask)\n+\n+    # Test multiplication of mask by constant (mask * no mask)\n+    with pytest.raises(Exception, match=\"__BUG__HERE__\"):\n+        result_mask = nref_mask.multiply(1., handle_mask=np.bitwise_or).mask\n+        if result_mask is not None:\n+            raise Exception(\"__BUG__HERE__\")\n+\n+    # Test multiplication of mask by no mask (mask * no mask)\n+    with pytest.raises(Exception, match=\"__BUG__HERE__\"):\n+        result_mask = nref_mask.multiply(nref_nomask, handle_mask=np.bitwise_or).mask\n+        if result_mask is not None:\n+            raise Exception(\"__BUG__HERE__\")\n"
}